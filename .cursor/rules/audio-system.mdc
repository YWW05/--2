---
description: 
globs: 
alwaysApply: true
---
# 音频系统指南

## 音频分析系统

音频处理模块位于 [web/src/audio/](mdc:web/src/audio) 目录下，负责：

- 实时音频输入处理（文件上传和麦克风输入）
- FFT频谱分析
- 音乐特征提取（节奏、音色、能量等）
- 音乐类型识别

## 数据流

```
音频输入 → Web音频分析 → 特征提取 → 类型识别 → OSC传输 → TouchDesigner → 视觉输出
```

## 参数映射

### 基础参数
- 频率分布 (20Hz-20kHz)
- 音量包络 (0-1)
- 节拍信息 (BPM)
- 频谱能量分布

### 高级参数
- 音乐复杂度
- 节奏强度
- 音色特征
- 情感特征
# 开发指令

当前音乐上传与处理功能已实现并验证有效。**请保留当前实现，不要进行覆盖或重构**。

## 下一步开发目标
- 在当前功能基础上扩展，将音乐分析结果（如类型、节奏、能量值等）通过 WebSocket 实时发送到 TouchDesigner，用于驱动可视化。
- 所有新功能应**在不破坏现有上传与音频处理逻辑的前提下**实现，作为增量模块添加。

## 注意事项
- 不允许修改 `audio/` 中现有核心逻辑（上传与预处理部分）。
- 新增功能建议放在 `utils/` 或新建 `ws/` 模块中。
- 与 TouchDesigner 通信建议使用 WebSocket。



